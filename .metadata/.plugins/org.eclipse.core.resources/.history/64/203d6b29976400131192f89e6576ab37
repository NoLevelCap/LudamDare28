package com.nolevelcap.player;

import java.awt.Rectangle;
import java.io.IOException;

import org.lwjgl.input.Keyboard;
import org.lwjgl.opengl.Display;
import org.lwjgl.util.vector.Vector2f;

import com.nolevelcap.main.MainGame;
import com.nolevelcap.world.World;

import mdesl.graphics.SpriteBatch;
import mdesl.graphics.Texture;

public class Player {

	private Texture player;
	private SpriteBatch draw;
	private int width = 64;
	private int height = 128;
	private Vector2f location;
	private float YVelocity;
	private float YAcceleration;
	private Rectangle collisionBox;
	private World world;
	private Physics physics;
	private float ly, dy;
	
	public Player(SpriteBatch draw, World world, Physics physics){
		this.world = world;
		this.physics = physics;
		this.draw = draw;
		try {
			this.player = new Texture(this.draw.getResource("player//player_Animation 1_0.png"));
		} catch (IOException e) {
			e.printStackTrace();
		}
		location = new Vector2f(50, 100);
		collisionBox = new Rectangle((int) location.x, (int) location.y, width, height);
		ly = location.y;
		dy = location.y;
	}
	
	public void render(){
		draw.begin();
		draw.draw(player, location.x, location.y, width, height);
		draw.end();
	}
	
	public void logic(){
		
		YAcceleration  = physics.getNewAcceleration(YAcceleration);
		
		YVelocity = physics.getVelocity(YVelocity, YAcceleration);
		
		dy = physics.getNewY(YVelocity, dy);
		
		Rectangle desiredRect = new Rectangle((int) location.x,(int) dy, width, height);
		
		for(int vno = 0; vno<= 2; vno++){
			for(int lineno = 0; lineno<= 49; lineno++){
				if(physics.checkForCollision(desiredRect, world.Tiles[lineno][vno].collisionBox)){
				System.out.println("collision");
				YVelocity = 0;
				dy = ly;
				}
			}
		}
		
		ly = dy;
		location.y = dy;
		System.out.println(location.y);
	}
	
public void checkForInput(){
		//Controls to be placed here
		Display.processMessages();
		
		if (Keyboard.isKeyDown(Keyboard.KEY_A)) {
		    System.out.println("A KEY IS DOWN");
		}
		
		//For toggle inputs
		while (Keyboard.next()) {
		    if (Keyboard.getEventKeyState()) {
		        if (Keyboard.getEventKey() == Keyboard.KEY_SPACE) {
			    System.out.println("Space Key Pressed");
		        }
		    } else {
		        if (Keyboard.getEventKey() == Keyboard.KEY_SPACE) {
			    System.out.println("Space Key Released");
		        }
		    }
		}
	}
}
